# 新功能使用指南

## 🎉 新功能概览

恭喜！你的云盘现在拥有了4个强大的新功能：

1. ✅ **批量操作** - 多选、批量下载、批量删除
2. ✅ **拖拽上传** - 拖文件到浏览器即可上传
3. ✅ **二维码分享** - 扫码直达分享链接
4. ✅ **网格视图** - 图片浏览更直观

---

## 📦 功能一：批量操作

### 使用方法

#### 1. 选择文件
- **单选**：点击文件前面的复选框
- **全选**：点击工具栏的"全选"按钮
- **部分选择**：选择几个文件后，"全选"按钮会显示"已选 X"

#### 2. 批量操作栏
选择文件后，屏幕底部会自动弹出批量操作工具栏：

```
┌────────────────────────────────────┐
│ 已选择 3 个文件                     │
│ [下载] [移动] [删除] [取消]         │
└────────────────────────────────────┘
```

#### 3. 批量下载
- 选中文件后点击"下载"按钮
- 单个文件：直接下载
- 多个文件：自动打包成ZIP下载
- 文件名格式：`批量下载_20231220_143022.zip`

#### 4. 批量删除
- 点击"删除"按钮
- 确认后批量删除选中的文件
- 显示成功/失败数量

#### 5. 取消选择
- 点击"取消"按钮
- 或再次点击"全选"按钮

### 快捷键（未来）
```
Ctrl + A  → 全选
Ctrl + D  → 批量下载
Delete    → 批量删除
Esc       → 取消选择
```

### 注意事项
- ⚠️ 批量删除无法恢复（未来会添加回收站）
- ⚠️ 文件夹暂不支持批量下载
- ⚠️ 批量操作有数量限制（建议不超过100个）

---

## 🎯 功能二：拖拽上传

### 使用方法

#### 1. 基础拖拽
```
1. 从文件管理器选择文件
2. 拖动到浏览器的文件列表区域
3. 看到紫色遮罩层（"松开鼠标上传文件"）
4. 松开鼠标
5. 自动开始上传
```

#### 2. 多文件拖拽
- 支持同时拖拽多个文件
- 自动批量上传
- 显示每个文件的上传进度

#### 3. 视觉反馈
```
默认状态：正常文件列表
拖拽进入：显示紫色全屏遮罩
         "松开鼠标上传文件"
         "支持多文件同时上传"
松开鼠标：开始上传，显示进度
```

### 限制说明
- ✅ 支持：多文件、大文件
- ❌ 不支持：文件夹（浏览器限制）
- ⚠️ 超过大小限制的文件会被过滤

### 使用技巧
1. **快速上传**：直接拖拽比点击按钮更快
2. **批量上传**：一次拖拽多个文件
3. **结合现有功能**：拖拽后自动打开上传对话框

---

## 📱 功能三：二维码分享

### 使用方法

#### 1. 创建分享
```
1. 点击文件的"分享"按钮
2. 设置分享选项（有效期、提取码）
3. 点击"创建分享"
4. 自动生成分享链接和二维码
```

#### 2. 使用二维码
```
┌─────────────────────┐
│   扫码访问          │
│  ┌─────────┐        │
│  │ QR Code │        │
│  │         │        │
│  └─────────┘        │
│ 使用手机扫描二维码  │
│ [下载二维码]        │
└─────────────────────┘
```

#### 3. 下载二维码
- 点击"下载二维码"按钮
- 保存为PNG图片
- 可打印或发送给他人

### 使用场景

#### 场景1：现场分享
```
面对面分享文件：
1. 创建分享链接
2. 展示二维码
3. 对方扫码直接访问
4. 无需输入长链接
```

#### 场景2：海报/传单
```
打印二维码：
1. 下载二维码图片
2. 添加到海报/传单
3. 他人扫码访问
```

#### 场景3：社交分享
```
微信/QQ分享：
1. 下载二维码
2. 发送图片
3. 对方长按识别
```

### 技术说明
- 使用QRCode.js库生成
- 纠错级别：H（最高）
- 尺寸：200x200px
- 支持所有主流扫码APP

---

## 🖼️ 功能四：网格视图

### 使用方法

#### 1. 切换视图
- **列表视图**：点击 📃 按钮（默认）
- **网格视图**：点击 ⊞ 按钮

#### 2. 列表视图（传统）
```
┌────────────────────────────────────┐
│ □ 文件名    大小    日期    操作    │
├────────────────────────────────────┤
│ □ 📄 文档.pdf  2.5MB  今天   [📥🔗✏️🗑️] │
│ □ 🖼️ 图片.jpg  1.2MB  昨天   [📥🔗✏️🗑️] │
└────────────────────────────────────┘
```

#### 3. 网格视图（新增）
```
┌────────┬────────┬────────┐
│ □      │ □      │ □      │
│ ┌────┐ │ ┌────┐ │ ┌────┐ │
│ │图片│ │ │文档│ │ │视频│ │
│ └────┘ │ └────┘ │ └────┘ │
│ 图片.jpg│ 文档.pdf│ 视频.mp4│
│ 1.2 MB │ 2.5 MB │ 50 MB  │
│ [📥🔗]  │ [📥🔗]  │ [📥🔗]  │
└────────┴────────┴────────┘
```

### 视图特点

#### 列表视图适合
- ✅ 查看详细信息（大小、日期）
- ✅ 文档类文件
- ✅ 精确查找
- ✅ 批量操作

#### 网格视图适合
- ✅ 浏览图片
- ✅ 视觉识别
- ✅ 快速预览
- ✅ 照片管理

### 自动记忆
- 系统会记住你的偏好
- 下次访问自动使用上次的视图
- 存储在浏览器本地

### 响应式设计
```
桌面：4-6列网格
平板：3-4列网格
手机：2列网格
```

---

## 🚀 部署步骤

### Windows端提交
```powershell
cd F:\Github\RaspiOwnCloud

git add frontend/css/style.css
git add frontend/js/batch-operations.js
git add frontend/js/drag-upload.js
git add frontend/js/grid-view.js
git add frontend/js/qrcode-share.js
git add frontend/js/main.js
git add frontend/index.html
git add backend/main.py

git commit -m "新增4大功能：批量操作、拖拽上传、二维码分享、网格视图"
git push origin main
```

### 树莓派部署
```bash
ssh pi@raspberrypi.local
cd ~/Desktop/Github/RaspiOwnCloud
git pull origin main
bash scripts/quick_update.sh
```

### 验证部署
```bash
# 检查文件
ls -lh /var/www/raspberrycloud/js/batch-operations.js
ls -lh /var/www/raspberrycloud/js/drag-upload.js
ls -lh /var/www/raspberrycloud/js/grid-view.js
ls -lh /var/www/raspberrycloud/js/qrcode-share.js

# 检查服务
sudo systemctl status raspberrycloud
```

---

## ✅ 功能测试清单

### 批量操作测试
- [ ] 单选文件
- [ ] 全选文件
- [ ] 批量下载（单个文件）
- [ ] 批量下载（多个文件，生成ZIP）
- [ ] 批量删除
- [ ] 取消选择
- [ ] 底部工具栏正常显示/隐藏

### 拖拽上传测试
- [ ] 拖拽单个文件
- [ ] 拖拽多个文件
- [ ] 拖拽时显示遮罩层
- [ ] 松开后开始上传
- [ ] 上传进度正常显示
- [ ] 文件夹被正确过滤

### 二维码分享测试
- [ ] 创建分享后显示二维码
- [ ] 二维码可以正常扫描
- [ ] 扫描后能访问分享页面
- [ ] 下载二维码功能正常
- [ ] 关闭对话框后二维码清除

### 网格视图测试
- [ ] 切换到网格视图
- [ ] 切换到列表视图
- [ ] 网格视图显示图片缩略图
- [ ] 文件夹和文件显示正确图标
- [ ] 操作按钮可用
- [ ] 刷新页面后记住视图选择

---

## 💡 使用技巧

### 提升效率组合

#### 组合1：快速整理
```
1. 切换到网格视图
2. 快速浏览识别文件
3. 多选需要的文件
4. 批量下载或删除
```

#### 组合2：快速上传
```
1. 打开文件管理器
2. 选择多个文件
3. 直接拖拽到浏览器
4. 自动批量上传
```

#### 组合3：移动分享
```
1. 创建分享链接
2. 展示二维码
3. 手机扫码访问
4. 移动端查看/下载
```

### 高级技巧

#### 技巧1：批量重命名（配合选择）
```
未来功能：
1. 多选文件
2. 批量重命名
3. 自动编号
```

#### 技巧2：智能相册（网格视图）
```
1. 切换到网格视图
2. 筛选图片类型
3. 浏览照片更直观
4. 配合批量操作
```

---

## 🐛 常见问题

### Q1: 批量下载很慢？
**原因**：打包需要时间
**解决**：
- 减少文件数量
- 避免下载大文件
- 分批下载

### Q2: 拖拽不响应？
**检查**：
- 是否拖到文件列表区域
- 浏览器是否支持（现代浏览器都支持）
- 刷新页面重试

### Q3: 二维码无法扫描？
**解决**：
- 确保二维码完整显示
- 调整屏幕亮度
- 使用高质量扫码APP
- 下载二维码后打印

### Q4: 网格视图图片不显示？
**原因**：缩略图生成问题
**解决**：
- 刷新页面
- 检查图片格式
- 等待缩略图生成

---

## 📊 性能优化

### 批量操作优化
- 限制选择数量（< 100个）
- 大文件批量下载建议分批
- 删除操作有进度提示

### 拖拽上传优化
- 自动过滤超大文件
- 并发上传控制
- 失败自动重试

### 网格视图优化
- 懒加载缩略图
- 虚拟滚动（大量文件）
- 图片压缩优化

---

## 🎯 下一步计划

### 即将推出
1. **回收站** - 防止误删
2. **文件标签** - 更好的组织
3. **高级搜索** - 快速找到文件
4. **深色模式** - 护眼舒适
5. **Office预览** - 在线查看文档

### 长期规划
- 文件版本控制
- 在线编辑
- 智能分类
- AI识别

---

## 🎉 享受新功能！

现在你的云盘功能更强大了！

- 🚀 批量操作提升效率
- 🎯 拖拽上传更便捷
- 📱 二维码分享更灵活
- 🖼️ 网格视图更直观

祝使用愉快！有任何问题随时反馈。



