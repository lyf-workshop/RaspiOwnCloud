# 树莓派私有云存储系统 (RaspberryCloud)

完整的私有云存储解决方案，功能对标百度网盘，专为树莓派优化。

## 📋 方案概述

### 系统架构

```
用户设备（电脑/手机）
    ↓ HTTPS
Nginx 反向代理 (端口80/443)
    ↓
FastAPI 后端服务 (端口8000)
    ↓
├── SQLite/MariaDB (用户信息、文件元数据)
└── 外接存储 (实际文件存储)
```

### 核心特性

- ✅ 文件上传/下载（支持断点续传，单文件最大10GB+）
- ✅ 文件管理（新建、删除、重命名、移动、搜索）
- ✅ 在线预览（图片、PDF、视频、音频）
- ✅ 多用户系统（管理员/普通用户，配额管理）
- ✅ 文件分享（链接+提取码，可设置有效期）
- ✅ 多端访问（Web端、局域网磁盘挂载、外网访问）
- ✅ 自动同步（多设备增量同步）
- ✅ 安全加固（HTTPS、密码哈希、防火墙）

### 硬件要求

| 组件 | 最低要求 | 推荐配置 |
|------|---------|---------|
| 树莓派型号 | 树莓派4B 2GB | 树莓派5 8GB |
| 外接存储 | USB 3.0 硬盘/U盘 ≥64GB | USB 3.0 移动硬盘 ≥1TB |
| 电源 | 5V/3A USB-C | 5V/5A USB-C（带硬盘） |
| SD卡 | Class 10 ≥32GB | UHS-I ≥64GB |
| 网络 | 有线/无线 | 千兆有线网络 |

**外接存储要求**：
- 格式：ext4（推荐）、NTFS（兼容Windows）、exFAT
- 接口：USB 3.0以上（读写速度≥100MB/s）
- 可选RAID：支持2块硬盘组RAID1镜像（需USB Hub）

### 资源占用（实测）

- 内存占用：空闲时 ~80MB，单用户上传时 ~150MB
- CPU占用：空闲时 <5%，文件传输时 15-30%
- 存储占用：系统文件 ~500MB，数据库 <100MB

## 📦 项目结构

```
私有云存储系统/
├── README.md                    # 本文件
├── docs/                        # 文档目录
│   ├── 01-硬件准备与初始化.md
│   ├── 02-系统部署教程.md
│   ├── 03-多端访问配置.md
│   ├── 04-安全加固指南.md
│   └── 05-问题排查手册.md
├── backend/                     # 后端代码
│   ├── main.py                 # FastAPI主程序
│   ├── models.py               # 数据库模型
│   ├── auth.py                 # 认证模块
│   ├── file_handler.py         # 文件处理模块
│   ├── share.py                # 分享模块
│   ├── sync.py                 # 同步模块
│   ├── config.py               # 配置文件
│   ├── requirements.txt        # Python依赖
│   └── database.sql            # 数据库初始化脚本
├── frontend/                    # 前端代码
│   ├── index.html              # 主页面
│   ├── login.html              # 登录页面
│   ├── css/
│   │   └── style.css
│   └── js/
│       ├── main.js
│       ├── upload.js
│       └── preview.js
├── config/                      # 配置文件
│   ├── nginx.conf              # Nginx配置
│   ├── raspberrycloud.service  # systemd服务
│   └── .env.example            # 环境变量示例
├── scripts/                     # 部署脚本
│   ├── install.sh              # 一键安装脚本
│   ├── mount_storage.sh        # 存储挂载脚本
│   ├── backup.sh               # 备份脚本
│   └── update.sh               # 更新脚本
└── tests/                       # 测试脚本
    └── test_api.py
```

## 🚀 快速开始

### 一键安装（推荐）

```bash
cd 私有云存储系统
sudo bash scripts/install.sh
```

### 手动安装

详见文档目录：
1. [硬件准备与初始化](docs/01-硬件准备与初始化.md)
2. [系统部署教程](docs/02-系统部署教程.md)
3. [多端访问配置](docs/03-多端访问配置.md)
4. [安全加固指南](docs/04-安全加固指南.md)

## 📱 访问方式

- **局域网Web访问**：http://树莓派IP
- **外网访问**：https://你的域名.com
- **局域网磁盘挂载**：\\树莓派IP\cloud (Windows) 或 smb://树莓派IP/cloud (Mac/Linux)

## 🔐 默认账户

- 管理员账号：admin
- 默认密码：RaspberryCloud2024!
- ⚠️ **首次登录后立即修改密码！**

## 📊 性能基准

基于树莓派5测试：
- 上传速度：局域网 ~90MB/s，外网受限于上行带宽
- 下载速度：局域网 ~110MB/s，外网受限于下行带宽
- 并发用户：建议≤10人同时使用
- 存储容量：受限于外接硬盘大小

## 🛠️ 技术栈

- **操作系统**：Raspberry Pi OS 64位 (Bookworm)
- **后端框架**：FastAPI (Python 3.11+)
- **数据库**：SQLite (≤3用户) / MariaDB (3+用户)
- **Web服务器**：Nginx
- **前端**：原生HTML/CSS/JS（无框架依赖）
- **文件系统**：Samba (局域网共享)
- **安全**：Let's Encrypt (HTTPS证书)

## 📚 文档导航

- [硬件准备与初始化](docs/01-硬件准备与初始化.md) - 树莓派系统烧录、存储挂载、初始配置
- [系统部署教程](docs/02-系统部署教程.md) - 后端/前端/数据库/Nginx完整部署
- [多端访问配置](docs/03-多端访问配置.md) - 局域网/外网/移动端访问设置
- [安全加固指南](docs/04-安全加固指南.md) - HTTPS、防火墙、权限配置
- [问题排查手册](docs/05-问题排查手册.md) - 常见问题及解决方案

## 🔄 更新日志

- **v1.0.0** (2024-12) - 初始版本发布

## 📄 开源协议

MIT License

## 🙋 技术支持

遇到问题？查看[问题排查手册](docs/05-问题排查手册.md)或提交Issue。

