# é—®é¢˜æ’æŸ¥æ‰‹å†Œ

å®Œæ•´çš„æ•…éšœè¯Šæ–­å’Œé—®é¢˜è§£å†³æŒ‡å—ã€‚

## ğŸ“‹ å¿«é€Ÿè¯Šæ–­æµç¨‹

```
1. ç¡®è®¤é—®é¢˜ç°è±¡
   â†“
2. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
   â†“
3. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
   â†“
4. éªŒè¯é…ç½®æ–‡ä»¶
   â†“
5. æµ‹è¯•ç½‘ç»œè¿æ¥
   â†“
6. åº”ç”¨è§£å†³æ–¹æ¡ˆ
   â†“
7. éªŒè¯é—®é¢˜è§£å†³
```

## ğŸ” ä¸€ã€æœåŠ¡æ— æ³•å¯åŠ¨

### 1.1 åç«¯æœåŠ¡æ— æ³•å¯åŠ¨

**ç°è±¡**ï¼šsystemctl statusæ˜¾ç¤ºfailedæˆ–inactive

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status raspberrycloud

# 2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sudo journalctl -u raspberrycloud -n 50 --no-pager

# 3. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
sudo tail -100 /var/log/raspberrycloud/backend_error.log
```

**å¸¸è§åŸå› åŠè§£å†³æ–¹æ¡ˆ**ï¼š

#### åŸå› 1ï¼šç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥8000ç«¯å£
sudo lsof -i :8000

# è§£å†³æ–¹æ¡ˆï¼šæ€æ­»å ç”¨è¿›ç¨‹
sudo kill -9 <PID>

# æˆ–ä¿®æ”¹æœåŠ¡ç«¯å£
sudo nano /etc/systemd/system/raspberrycloud.service
# ä¿®æ”¹ --port 8000 ä¸ºå…¶ä»–ç«¯å£
sudo systemctl daemon-reload
sudo systemctl restart raspberrycloud
```

#### åŸå› 2ï¼šPythonä¾èµ–ç¼ºå¤±

```bash
# æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
source /opt/raspberrycloud/venv/bin/activate
python -c "import fastapi"

# å¦‚æœæŠ¥é”™ï¼Œé‡æ–°å®‰è£…ä¾èµ–
cd /opt/raspberrycloud
pip install -r requirements.txt
```

#### åŸå› 3ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
ls -la /opt/raspberrycloud/backend/raspberrycloud.db

# å¦‚æœæ˜¯MariaDB
sudo systemctl status mariadb
sudo mysql -u clouduser -p -e "SHOW DATABASES;"

# æ£€æŸ¥.envé…ç½®
sudo nano /opt/raspberrycloud/backend/.env
# éªŒè¯DATABASE_URLæ˜¯å¦æ­£ç¡®
```

#### åŸå› 4ï¼šæƒé™é—®é¢˜

```bash
# ä¿®å¤æƒé™
sudo chown -R www-data:www-data /opt/raspberrycloud
sudo chmod -R 755 /opt/raspberrycloud

# é‡å¯æœåŠ¡
sudo systemctl restart raspberrycloud
```

### 1.2 Nginxæ— æ³•å¯åŠ¨

**ç°è±¡**ï¼šnginx -tæµ‹è¯•å¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# æµ‹è¯•é…ç½®
sudo nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -50 /var/log/nginx/error.log
```

**å¸¸è§åŸå› åŠè§£å†³æ–¹æ¡ˆ**ï¼š

#### åŸå› 1ï¼šé…ç½®è¯­æ³•é”™è¯¯

```bash
# è¯¦ç»†æ£€æŸ¥é…ç½®
sudo nginx -t 2>&1

# æ ¹æ®é”™è¯¯æç¤ºä¿®æ”¹é…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/raspberrycloud

# å¸¸è§é”™è¯¯ï¼š
# - ç¼ºå°‘åˆ†å· ;
# - èŠ±æ‹¬å·ä¸åŒ¹é…
# - æŒ‡ä»¤æ‹¼å†™é”™è¯¯
```

#### åŸå› 2ï¼šç«¯å£å†²çª

```bash
# æ£€æŸ¥80ç«¯å£
sudo lsof -i :80

# å¦‚æœApacheå ç”¨
sudo systemctl stop apache2
sudo systemctl disable apache2
```

#### åŸå› 3ï¼šSSLè¯ä¹¦è·¯å¾„é”™è¯¯

```bash
# æ£€æŸ¥è¯ä¹¦æ–‡ä»¶
sudo ls -la /etc/letsencrypt/live/your-domain.com/

# å¦‚æœä¸å­˜åœ¨ï¼Œæ³¨é‡ŠHTTPSé…ç½®æˆ–é‡æ–°ç”³è¯·è¯ä¹¦
sudo certbot certonly --nginx -d your-domain.com
```

## ğŸŒ äºŒã€ç½‘ç»œè®¿é—®é—®é¢˜

### 2.1 æ— æ³•è®¿é—®Webç•Œé¢

**ç°è±¡**ï¼šæµè§ˆå™¨æ˜¾ç¤º"æ— æ³•è®¿é—®æ­¤ç½‘ç«™"

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. Pingæµ‹è¯•
ping æ ‘è“æ´¾IP

# 2. ç«¯å£æµ‹è¯•
telnet æ ‘è“æ´¾IP 80
# æˆ–
nc -zv æ ‘è“æ´¾IP 80

# 3. æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# 4. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status nginx
sudo systemctl status raspberrycloud
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# å¼€æ”¾ç«¯å£
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# ç¡®ä¿æœåŠ¡è¿è¡Œ
sudo systemctl start nginx
sudo systemctl start raspberrycloud

# æ£€æŸ¥Nginxç›‘å¬
sudo netstat -tlnp | grep nginx
```

### 2.2 502 Bad Gatewayé”™è¯¯

**ç°è±¡**ï¼šNginxè¿”å›502é”™è¯¯

**åŸå› **ï¼šåç«¯æœåŠ¡æœªè¿è¡Œæˆ–è¿æ¥å¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥åç«¯æœåŠ¡
sudo systemctl status raspberrycloud

# 2. æ£€æŸ¥åç«¯ç›‘å¬
curl http://localhost:8000/api/health

# 3. æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -50 /var/log/nginx/raspberrycloud_error.log
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# é‡å¯åç«¯æœåŠ¡
sudo systemctl restart raspberrycloud

# ç­‰å¾…æœåŠ¡å¯åŠ¨
sleep 5

# é‡å¯Nginx
sudo systemctl restart nginx

# éªŒè¯
curl -I http://localhost/api/health
```

### 2.3 404 Not Foundé”™è¯¯

**ç°è±¡**ï¼šé™æ€æ–‡ä»¶æˆ–APIè¿”å›404

**åŸå› 1ï¼šå‰ç«¯æ–‡ä»¶æœªæ­£ç¡®éƒ¨ç½²**

```bash
# æ£€æŸ¥å‰ç«¯æ–‡ä»¶
ls -la /var/www/raspberrycloud/

# é‡æ–°å¤åˆ¶å‰ç«¯æ–‡ä»¶
sudo cp -r /path/to/frontend/* /var/www/raspberrycloud/
sudo chown -R www-data:www-data /var/www/raspberrycloud
```

**åŸå› 2ï¼šNginx locationé…ç½®é”™è¯¯**

```bash
sudo nano /etc/nginx/sites-available/raspberrycloud
# æ£€æŸ¥locationå—é…ç½®
sudo nginx -t
sudo systemctl reload nginx
```

### 2.4 å¤–ç½‘æ— æ³•è®¿é—®

**ç°è±¡**ï¼šå±€åŸŸç½‘å¯è®¿é—®ï¼Œå¤–ç½‘æ— æ³•è®¿é—®

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. éªŒè¯ç«¯å£æ˜ å°„
# åœ¨å¤–ç½‘ç”¨æ‰‹æœº4Gè®¿é—®: http://å…¬ç½‘IP:æ˜ å°„ç«¯å£

# 2. æ£€æŸ¥DDNSè§£æ
nslookup your-domain.com
# æˆ–
dig your-domain.com

# 3. æµ‹è¯•ç«¯å£å¼€æ”¾
# ä½¿ç”¨åœ¨çº¿å·¥å…·: http://tool.chinaz.com/port/
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```
1. é‡æ–°é…ç½®è·¯ç”±å™¨ç«¯å£æ˜ å°„
   - ç¡®è®¤å†…éƒ¨IPä¸ºæ ‘è“æ´¾é™æ€IP
   - ç¡®è®¤å†…éƒ¨ç«¯å£ä¸º80/443
   - ç¡®è®¤å¤–éƒ¨ç«¯å£æœªè¢«å ç”¨

2. æ›´æ–°DDNS
   - ç™»å½•DDNSæœåŠ¡å•†åå°
   - æ‰‹åŠ¨æ›´æ–°IPåœ°å€
   - é‡å¯DDNSå®¢æˆ·ç«¯æœåŠ¡

3. æ£€æŸ¥è¿è¥å•†é™åˆ¶
   - æŸäº›è¿è¥å•†å°ç¦80/443ç«¯å£
   - ä½¿ç”¨8080/8443ç­‰ç«¯å£
```

## ğŸ“ ä¸‰ã€æ–‡ä»¶æ“ä½œé—®é¢˜

### 3.1 æ–‡ä»¶ä¸Šä¼ å¤±è´¥

**ç°è±¡**ï¼šä¸Šä¼ æ–‡ä»¶æ—¶æŠ¥é”™æˆ–è¿›åº¦å¡ä½

**åŸå› 1ï¼šæ–‡ä»¶è¿‡å¤§**

```bash
# æ£€æŸ¥é…ç½®
sudo nano /opt/raspberrycloud/backend/.env
# æŸ¥çœ‹ MAX_FILE_SIZE è®¾ç½®

# æ£€æŸ¥Nginxé™åˆ¶
sudo nano /etc/nginx/sites-available/raspberrycloud
# æŸ¥çœ‹ client_max_body_size
```

**åŸå› 2ï¼šå­˜å‚¨ç©ºé—´ä¸è¶³**

```bash
# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h /mnt/cloud_storage

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
sudo rm -rf /mnt/cloud_storage/temp/*

# æ£€æŸ¥ç”¨æˆ·é…é¢
# é€šè¿‡Webç•Œé¢æˆ–APIæŸ¥çœ‹
```

**åŸå› 3ï¼šæƒé™é—®é¢˜**

```bash
# ä¿®å¤æƒé™
sudo chown -R www-data:www-data /mnt/cloud_storage
sudo chmod -R 755 /mnt/cloud_storage

# æ£€æŸ¥SELinuxï¼ˆå¦‚æœå¯ç”¨ï¼‰
sudo setenforce 0  # ä¸´æ—¶ç¦ç”¨æµ‹è¯•
```

### 3.2 æ–‡ä»¶ä¸‹è½½å¤±è´¥

**ç°è±¡**ï¼šç‚¹å‡»ä¸‹è½½æ— å“åº”æˆ–ä¸‹è½½ä¸­æ–­

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
sudo ls -la /mnt/cloud_storage/users/*/filename

# 2. æ£€æŸ¥Nginxè¶…æ—¶è®¾ç½®
sudo nano /etc/nginx/sites-available/raspberrycloud
# æŸ¥çœ‹proxy_read_timeoutç­‰è®¾ç½®

# 3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -50 /var/log/nginx/raspberrycloud_error.log
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```nginx
# å¢åŠ è¶…æ—¶æ—¶é—´
proxy_read_timeout 3600s;
proxy_send_timeout 3600s;
client_body_timeout 3600s;
```

### 3.3 æ— æ³•åˆ é™¤æ–‡ä»¶

**ç°è±¡**ï¼šåˆ é™¤æ“ä½œæ— å“åº”æˆ–æŠ¥é”™

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ‰€æœ‰æƒ
sudo ls -la /path/to/file

# 2. æ£€æŸ¥è¿›ç¨‹å ç”¨
sudo lsof /path/to/file

# 3. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
sudo tail -50 /var/log/raspberrycloud/backend.log
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# å¼ºåˆ¶åˆ é™¤ï¼ˆå°å¿ƒï¼ï¼‰
sudo rm -f /path/to/file

# é‡å¯æœåŠ¡
sudo systemctl restart raspberrycloud
```

## ğŸ” å››ã€è®¤è¯é—®é¢˜

### 4.1 æ— æ³•ç™»å½•

**ç°è±¡**ï¼šè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå¯†ç ä»æ— æ³•ç™»å½•

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥æ•°æ®åº“
sqlite3 /opt/raspberrycloud/backend/raspberrycloud.db "SELECT * FROM users;"

# 2. æ£€æŸ¥tokenç”Ÿæˆ
sudo tail -50 /var/log/raspberrycloud/backend.log | grep -i auth

# 3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
# F12 â†’ Console â†’ æŸ¥çœ‹JavaScripté”™è¯¯
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### åŸå› 1ï¼šå¯†ç é”™è¯¯

```bash
# é‡ç½®ç®¡ç†å‘˜å¯†ç 
cd /opt/raspberrycloud/backend
source ../venv/bin/activate
python << EOF
from models import SessionLocal, User
db = SessionLocal()
admin = db.query(User).filter(User.username == 'admin').first()
admin.hashed_password = User.hash_password('NewPassword123!')
db.commit()
print("å¯†ç å·²é‡ç½®ä¸º: NewPassword123!")
EOF
```

#### åŸå› 2ï¼šæ•°æ®åº“æŸå

```bash
# å¤‡ä»½æ•°æ®åº“
cp /opt/raspberrycloud/backend/raspberrycloud.db /tmp/backup.db

# æ£€æŸ¥æ•°æ®åº“
sqlite3 /opt/raspberrycloud/backend/raspberrycloud.db "PRAGMA integrity_check;"

# å¦‚æœæŸåï¼Œä»å¤‡ä»½æ¢å¤
# æŸ¥çœ‹ /mnt/cloud_storage/backups/
```

### 4.2 Tokenè¿‡æœŸæˆ–æ— æ•ˆ

**ç°è±¡**ï¼šå·²ç™»å½•ä½†çªç„¶è¦æ±‚é‡æ–°ç™»å½•

**åŸå› **ï¼š

- SECRET_KEYè¢«ä¿®æ”¹
- ç³»ç»Ÿæ—¶é—´ä¸æ­£ç¡®
- Tokenå·²è¿‡æœŸ

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ£€æŸ¥ç³»ç»Ÿæ—¶é—´
date
# å¦‚æœä¸æ­£ç¡®
sudo timedatectl set-ntp true

# æ£€æŸ¥.envé…ç½®
sudo nano /opt/raspberrycloud/backend/.env
# ç¡®è®¤SECRET_KEYæœªè¢«ä¿®æ”¹
# ç¡®è®¤ACCESS_TOKEN_EXPIRE_MINUTESè®¾ç½®åˆç†

# é‡å¯æœåŠ¡
sudo systemctl restart raspberrycloud
```

## ğŸ’¾ äº”ã€æ•°æ®åº“é—®é¢˜

### 5.1 æ•°æ®åº“é”å®š

**ç°è±¡**ï¼šæ“ä½œæ—¶æç¤º"database is locked"

**åŸå› **ï¼šå¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®SQLite

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ£€æŸ¥è®¿é—®æ•°æ®åº“çš„è¿›ç¨‹
sudo lsof /opt/raspberrycloud/backend/raspberrycloud.db

# 2. é‡å¯æœåŠ¡
sudo systemctl restart raspberrycloud

# 3. å¦‚æœé¢‘ç¹å‘ç”Ÿï¼Œè€ƒè™‘å‡çº§åˆ°MariaDB
```

### 5.2 æ•°æ®åº“æ–‡ä»¶ä¸¢å¤±

**ç°è±¡**ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæç¤ºæ‰¾ä¸åˆ°æ•°æ®åº“

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æŸ¥æ‰¾æ•°æ®åº“
sudo find / -name "raspberrycloud.db" 2>/dev/null

# 2. ä»å¤‡ä»½æ¢å¤
sudo cp /mnt/cloud_storage/backups/database_latest.db.gz /tmp/
sudo gunzip /tmp/database_latest.db.gz
sudo cp /tmp/database_latest.db /opt/raspberrycloud/backend/raspberrycloud.db
sudo chown www-data:www-data /opt/raspberrycloud/backend/raspberrycloud.db

# 3. å¦‚æœæ— å¤‡ä»½ï¼Œé‡æ–°åˆå§‹åŒ–
cd /opt/raspberrycloud/backend
source ../venv/bin/activate
python -c "from models import init_db; init_db()"
```

## ğŸ—‚ï¸ å…­ã€å­˜å‚¨é—®é¢˜

### 6.1 å¤–æ¥ç¡¬ç›˜æœªæŒ‚è½½

**ç°è±¡**ï¼šå¯åŠ¨å/mnt/cloud_storageä¸ºç©º

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥æŒ‚è½½çŠ¶æ€
mountpoint /mnt/cloud_storage
df -h | grep cloud_storage

# 2. æŸ¥çœ‹è®¾å¤‡
lsblk
sudo fdisk -l

# 3. æ£€æŸ¥fstab
cat /etc/fstab | grep cloud_storage

# 4. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
dmesg | grep -i usb
dmesg | grep -i sda
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# æ‰‹åŠ¨æŒ‚è½½
sudo mount -a

# å¦‚æœå¤±è´¥ï¼Œæ£€æŸ¥è®¾å¤‡
sudo blkid
# æ›´æ–°fstabä¸­çš„UUID

# é‡æ–°è¿è¡ŒæŒ‚è½½è„šæœ¬
sudo bash /opt/raspberrycloud/scripts/mount_storage.sh
```

### 6.2 å­˜å‚¨ç©ºé—´ä¸è¶³

**ç°è±¡**ï¼šä¸Šä¼ å¤±è´¥ï¼Œæç¤ºç©ºé—´ä¸è¶³

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h /mnt/cloud_storage

# 2. æŸ¥çœ‹å¤§æ–‡ä»¶
sudo du -sh /mnt/cloud_storage/*
sudo find /mnt/cloud_storage -type f -size +1G -exec ls -lh {} \;

# 3. æ£€æŸ¥ç”¨æˆ·ä½¿ç”¨æƒ…å†µ
sudo du -sh /mnt/cloud_storage/users/*
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
sudo rm -rf /mnt/cloud_storage/temp/*

# 2. æ¸…ç†æ—§å¤‡ä»½
sudo rm -f /mnt/cloud_storage/backups/*_$(date -d '30 days ago' +%Y%m%d)*.gz

# 3. åˆ é™¤å·²æ ‡è®°åˆ é™¤çš„æ–‡ä»¶ï¼ˆéœ€è¦å¼€å‘æ¸…ç†è„šæœ¬ï¼‰
# æˆ–æ‰©å®¹å­˜å‚¨è®¾å¤‡
```

## âš™ï¸ ä¸ƒã€æ€§èƒ½é—®é¢˜

### 7.1 ç³»ç»Ÿè¿è¡Œç¼“æ…¢

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
# æˆ–
top

# 2. æ£€æŸ¥CPUæ¸©åº¦
vcgencmd measure_temp

# 3. æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h

# 4. æ£€æŸ¥ç£ç›˜I/O
iostat -x 1

# 5. æŸ¥çœ‹ç½‘ç»œæµé‡
iftop  # éœ€è¦å®‰è£…: sudo apt install iftop
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### åŸå› 1ï¼šCPUè¿‡çƒ­

```bash
# æ£€æŸ¥æ¸©åº¦
vcgencmd measure_temp

# å¦‚æœ>80Â°C
# - æ·»åŠ æ•£çƒ­ç‰‡/é£æ‰‡
# - æ”¹å–„é€šé£
# - é™ä½CPUé¢‘ç‡ï¼ˆä¸æ¨èï¼‰
```

#### åŸå› 2ï¼šå†…å­˜ä¸è¶³

```bash
# å¢åŠ SWAP
sudo nano /etc/dphys-swapfile
# ä¿®æ”¹ CONF_SWAPSIZE=2048
sudo /etc/init.d/dphys-swapfile restart

# é‡å¯æœåŠ¡ä»¥é‡Šæ”¾å†…å­˜
sudo systemctl restart raspberrycloud
```

#### åŸå› 3ï¼šç£ç›˜I/Oç“¶é¢ˆ

```bash
# æ£€æŸ¥SDå¡é€Ÿåº¦
sudo hdparm -t /dev/mmcblk0

# å»ºè®®ï¼š
# - ä½¿ç”¨SSDä½œä¸ºç³»ç»Ÿç›˜
# - å°†æ•°æ®å­˜å‚¨ç§»åˆ°USB 3.0ç¡¬ç›˜
# - å¯ç”¨Nginxç¼“å­˜
```

### 7.2 ä¸Šä¼ /ä¸‹è½½é€Ÿåº¦æ…¢

**æ’æŸ¥æ­¥éª¤**ï¼š

```bash
# 1. æµ‹è¯•å±€åŸŸç½‘é€Ÿåº¦
# ä½¿ç”¨iperf3
# æœåŠ¡ç«¯ï¼ˆæ ‘è“æ´¾ï¼‰
iperf3 -s

# å®¢æˆ·ç«¯ï¼ˆç”µè„‘ï¼‰
iperf3 -c æ ‘è“æ´¾IP

# 2. æ£€æŸ¥ç½‘ç»œè¿æ¥
ethtool eth0  # æœ‰çº¿ç½‘ç»œ
iwconfig wlan0  # æ— çº¿ç½‘ç»œ
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```
1. ä½¿ç”¨æœ‰çº¿ç½‘ç»œï¼ˆåƒå…†ç½‘çº¿+åƒå…†è·¯ç”±å™¨ï¼‰
2. å‡å°‘ç½‘ç»œå¹²æ‰°ï¼ˆWiFiä¿¡é“ä¼˜åŒ–ï¼‰
3. å‡çº§è·¯ç”±å™¨å›ºä»¶
4. å¯ç”¨Nginx gzipå‹ç¼©
5. ä¼˜åŒ–MTUå€¼
```

## ğŸ› ï¸ å…«ã€å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status raspberrycloud
sudo systemctl status nginx

# å¯åŠ¨/åœæ­¢/é‡å¯
sudo systemctl start raspberrycloud
sudo systemctl stop raspberrycloud
sudo systemctl restart raspberrycloud

# å¼€æœºè‡ªå¯
sudo systemctl enable raspberrycloud
sudo systemctl disable raspberrycloud

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u raspberrycloud -f
sudo journalctl -u raspberrycloud --since "10 minutes ago"
sudo journalctl -u raspberrycloud --since today
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# åº”ç”¨æ—¥å¿—
sudo tail -f /var/log/raspberrycloud/backend.log
sudo tail -f /var/log/raspberrycloud/backend_error.log

# Nginxæ—¥å¿—
sudo tail -f /var/log/nginx/raspberrycloud_access.log
sudo tail -f /var/log/nginx/raspberrycloud_error.log

# ç³»ç»Ÿæ—¥å¿—
sudo tail -f /var/log/syslog
sudo tail -f /var/log/auth.log
```

### æ•°æ®åº“æ“ä½œ

```bash
# SQLite
sqlite3 /opt/raspberrycloud/backend/raspberrycloud.db

# å¸¸ç”¨SQLå‘½ä»¤
.tables  # åˆ—å‡ºæ‰€æœ‰è¡¨
.schema users  # æŸ¥çœ‹è¡¨ç»“æ„
SELECT * FROM users;  # æŸ¥è¯¢ç”¨æˆ·
.exit  # é€€å‡º

# MariaDB
sudo mysql -u clouduser -p
SHOW DATABASES;
USE raspberrycloud;
SHOW TABLES;
SELECT * FROM users;
EXIT;
```

### ç½‘ç»œè¯Šæ–­

```bash
# æµ‹è¯•è¿æ¥
ping æ ‘è“æ´¾IP
telnet æ ‘è“æ´¾IP 80
curl -I http://localhost/api/health

# æŸ¥çœ‹ç«¯å£
sudo netstat -tlnp
sudo lsof -i :8000

# æŸ¥çœ‹è·¯ç”±
ip route

# DNSæŸ¥è¯¢
nslookup your-domain.com
dig your-domain.com
```

## ğŸ“ ä¹ã€è·å–å¸®åŠ©

### 9.1 æ”¶é›†è¯Šæ–­ä¿¡æ¯

è¿è¡Œè¯Šæ–­è„šæœ¬ï¼š

```bash
# åˆ›å»ºè¯Šæ–­è„šæœ¬
cat > /tmp/diagnose.sh << 'EOF'
#!/bin/bash
echo "=== RaspberryCloudè¯Šæ–­ä¿¡æ¯ ==="
echo "æ—¶é—´: $(date)"
echo ""

echo "=== ç³»ç»Ÿä¿¡æ¯ ==="
uname -a
cat /etc/os-release | grep PRETTY_NAME
echo ""

echo "=== æœåŠ¡çŠ¶æ€ ==="
systemctl status raspberrycloud --no-pager
systemctl status nginx --no-pager
echo ""

echo "=== ç£ç›˜ä½¿ç”¨ ==="
df -h
echo ""

echo "=== å†…å­˜ä½¿ç”¨ ==="
free -h
echo ""

echo "=== CPUæ¸©åº¦ ==="
vcgencmd measure_temp
echo ""

echo "=== æœ€è¿‘é”™è¯¯æ—¥å¿— ==="
sudo tail -30 /var/log/raspberrycloud/backend_error.log
sudo tail -30 /var/log/nginx/raspberrycloud_error.log
EOF

bash /tmp/diagnose.sh > /tmp/diagnose.txt
cat /tmp/diagnose.txt
```

### 9.2 ç¤¾åŒºæ”¯æŒ

- GitHub Issues: <é¡¹ç›®ä»“åº“åœ°å€>
- æ ‘è“æ´¾è®ºå›: https://forums.raspberrypi.com/
- FastAPIæ–‡æ¡£: https://fastapi.tiangolo.com/

### 9.3 æäº¤é—®é¢˜æ—¶åŒ…å«

1. é—®é¢˜è¯¦ç»†æè¿°
2. é‡ç°æ­¥éª¤
3. é¢„æœŸç»“æœ vs å®é™…ç»“æœ
4. è¯Šæ–­ä¿¡æ¯ï¼ˆdiagnose.txtï¼‰
5. ç›¸å…³æ—¥å¿—
6. ç³»ç»Ÿé…ç½®

## âœ… å¿«é€Ÿå‚è€ƒ

| é—®é¢˜ | å¿«é€Ÿè§£å†³ |
|------|---------|
| æœåŠ¡æ— æ³•å¯åŠ¨ | `sudo systemctl restart raspberrycloud` |
| 502é”™è¯¯ | æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ |
| 404é”™è¯¯ | æ£€æŸ¥å‰ç«¯æ–‡ä»¶å’ŒNginxé…ç½® |
| æ— æ³•ç™»å½• | é‡ç½®å¯†ç æˆ–æ£€æŸ¥æ•°æ®åº“ |
| ä¸Šä¼ å¤±è´¥ | æ£€æŸ¥ç£ç›˜ç©ºé—´å’Œæƒé™ |
| å¤–ç½‘æ— æ³•è®¿é—® | æ£€æŸ¥ç«¯å£æ˜ å°„å’ŒDDNS |
| ç³»ç»Ÿç¼“æ…¢ | æ£€æŸ¥CPUæ¸©åº¦å’Œå†…å­˜ |

## ğŸ‰ æ€»ç»“

é‡åˆ°é—®é¢˜ä¸è¦æ…Œï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. **ç¡®è®¤ç°è±¡** - å‡†ç¡®æè¿°é—®é¢˜
2. **æŸ¥çœ‹æ—¥å¿—** - æ—¥å¿—æ˜¯æœ€å¥½çš„è€å¸ˆ
3. **é€æ­¥æ’æŸ¥** - ä»ç®€å•åˆ°å¤æ‚
4. **éªŒè¯ä¿®å¤** - ç¡®ä¿é—®é¢˜çœŸæ­£è§£å†³
5. **è®°å½•ç»éªŒ** - é¿å…é‡å¤é—®é¢˜

å¤§éƒ¨åˆ†é—®é¢˜éƒ½å¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—å’Œé‡å¯æœåŠ¡è§£å†³ï¼


